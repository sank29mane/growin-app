---
phase: 05-research-augmentation
plan: 02
type: execute
wave: 2
depends_on: [05-01]
files_modified: [backend/agents/decision_agent.py]
autonomous: true
requirements: [DA-01, DA-02, DA-03]
must_haves:
  truths:
    - "DecisionAgent persona is 'Lead Financial Trader' (Assertive, Executive, yet Friendly)"
    - "DecisionAgent can trigger parallel multi-model specialist consultations in one burst"
    - "DecisionAgent reasoning trace correctly reflects parallel agentic execution"
  artifacts:
    - path: "backend/agents/decision_agent.py"
      provides: "Lead Financial Trader Decision Agent"
  key_links:
    - from: "backend/agents/decision_agent.py"
      to: "backend/lm_studio_client.py"
      via: "batch_chat"
---

<objective>
Elevate the Decision Agent's persona to 'Lead Financial Trader' and implement 'Parallel Multi-Model Completion' where it can trigger multiple specialist agents in a single parallel burst via the optimized LM Studio API.

Purpose: More authoritative and efficient decision synthesis.
Output: Upgraded Decision Agent with parallel consultation capability.
</objective>

<execution_context>
@/Users/sanketmane/.gemini/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@backend/agents/decision_agent.py
@backend/lm_studio_client.py
@backend/agents/coordinator_agent.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Persona Upgrade to Lead Financial Trader</name>
  <files>backend/agents/decision_agent.py</files>
  <action>
    - Update `_get_system_persona` to reflect the 'Lead Financial Trader' persona.
    - Style: Assertive, Executive, highly proficient, but friendly and approachable.
    - Remove overly verbose monolithic tags if they interfere with clarity.
    - Ensure it knows its role is the client-facing primary advisor.
  </action>
  <verify>Check system prompt for persona keywords (Assertive, Executive, Friendly).</verify>
  <done>Decision Agent uses the new persona for all user interactions.</done>
</task>

<task type="auto">
  <name>Task 2: Implement Parallel Consultation Bursts</name>
  <files>backend/agents/decision_agent.py</files>
  <action>
    - Refactor `make_decision` or `_run_agentic_loop` to support parallel tool execution if multiple tools are detected.
    - Specifically, if the LLM emits multiple `[TOOL:...]` markers, parse and execute them in parallel using `asyncio.gather` and the `batch_chat` capability of the `LMStudioClient`.
    - Allow the Decision Model to effectively trigger specialist "mini-agent" completions in a single burst.
  </action>
  <verify>Mock multiple tool calls and verify they execute concurrently.</verify>
  <done>Decision Agent can handle multiple specialist consultations in parallel.</done>
</task>

<task type="auto">
  <name>Task 3: Reason-Trace Integration for Parallel Execution</name>
  <files>backend/agents/decision_agent.py</files>
  <action>
    - Update telemetry logging during parallel bursts to correctly show "Parallel Consultation" in the reasoning trace.
    - Ensure that the `Strategic Synthesis` phase cleanly incorporates these parallel results without serializing the trace UI.
  </action>
  <verify>Check logs/telemetry during multi-specialist runs.</verify>
  <done>UI reasoning trace accurately represents parallel execution bursts.</done>
</task>

</tasks>

<verification>
Check for:
1. Updated system persona string.
2. Parallel tool/consultation logic in `_run_agentic_loop`.
</verification>

<success_criteria>
- New persona is active and clearly distinct.
- Specialist consultation is parallelized when possible.
</success_criteria>

<output>
After completion, create `.planning/phases/05-research-augmentation/05-02-SUMMARY.md`
</output>

---
phase: 08-system-professionalization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: ["backend/utils/audit_log.py", "backend/agents/coordinator_agent.py", "backend/agents/decision_agent.py"]
autonomous: true
requirements: [PROF-01, PROF-04]
---

<objective>
Professionalize the Audit Logging system and initiate the Dependency Injection refactor.

1. Implement hash-chaining in `AuditLogger` for tamper-evidence.
2. Refactor `CoordinatorAgent` and `DecisionAgent` to accept dependencies (MCP client) via constructor.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Audit Logging Integrity</name>
  <action>
    Update `backend/utils/audit_log.py`:
    - Ensure `log_event` correctly computes and chains hashes.
    - Add a `verify_integrity()` method to the `AuditLogger` class.
    - Test the chaining with a small script.
  </action>
</task>

<task type="auto">
  <name>Task 2: DI Refactor for Agents</name>
  <action>
    Refactor `CoordinatorAgent` and `DecisionAgent`:
    - Change `__init__` to accept `mcp_client` and `chat_manager` (or full `state`) as optional arguments.
    - Default to global `state` only if not provided.
    - Update `chat_routes.py` to instantiate them with the dependencies.
  </action>
</task>

</tasks>

<verification>
- Run a script to append 5 audit entries and verify the hash chain.
- Verify that `chat_routes.py` still functions with refactored agents.
</verification>

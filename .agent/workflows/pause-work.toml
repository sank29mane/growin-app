prompt = """<purpose>
Create `.continue-here.md` handoff file to preserve complete work state across sessions. Enables seamless resumption with full context restoration.
</purpose>

<required_reading>
Read all files referenced by the invoking prompt's execution_context before starting.
</required_reading>

<process>

<step name="research_augmentation">
**CRITICAL: Research Check-in**
Always ask the user: "would you like to update our deep research?"
If they say yes:
1. Identify the current technical focus (e.g. intraday prediction, M4 optimization).
2. Use the `notebooklm-deep-research` skill to augment the 'Growin Research' notebook.
3. Summarize the research start/status in the handoff.
</step>

<step name="detect">
Find current phase directory from most recently modified files:

```bash
# Find most recent phase directory with work
ls -lt .planning/phases/*/PLAN.md 2>/dev/null | head -1 | grep -oP 'phases/\K[^/]+'
```

If no active phase detected, ask user which phase they're pausing work on.
</step>

<step name="gather">
**Collect complete state for handoff:**

1. **Current position**: Which phase, which plan, which task
2. **Work completed**: What got done this session
3. **Work remaining**: What's left in current plan/phase
4. **Decisions made**: Key decisions and rationale
5. **Blockers/issues**: Anything stuck
6. **Mental context**: The approach, next steps, "vibe"
7. **Files modified**: What's changed but not committed

Ask user for clarifications if needed via conversational questions.
</step>

<step name="write">
**Write handoff to `.planning/phases/XX-name/.continue-here.md`:**

```markdown
---
phase: XX-name
task: 3
total_tasks: 7
status: in_progress
last_updated: [timestamp from current-timestamp]
---

<current_state>
[Where exactly are we? Immediate context]
</current_state>

<completed_work>

- Task 1: [name] - Done
- Task 2: [name] - Done
- Task 3: [name] - In progress, [what's done]
</completed_work>

<remaining_work>

- Task 3: [what's left]
- Task 4: Not started
- Task 5: Not started
</remaining_work>

<decisions_made>

- Decided to use [X] because [reason]
- Chose [approach] over [alternative] because [reason]
</decisions_made>

<blockers>
- [Blocker 1]: [status/workaround]
</blockers>

<context>
[Mental state, what were you thinking, the plan]
</context>

<research>
[Latest NotebookLM updates or pending research tasks]
</research>
```
</step>

<step name="commit">
Commit all planning and handoff documentation:

```bash
node /Users/sanketmane/.gemini/get-shit-done/bin/gsd-tools.cjs commit "wip: record state and handoff context"
```
</step>

<step name="confirm">
Confirm handoff is ready and remind user how to resume:
"Handoff recorded. Resume with `/gsd:resume-work`"
</step>

</process>"""

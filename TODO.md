# Growin Project: Comprehensive Master Plan & TODO

**Status**: Active Development
**Last Updated**: February 6, 2026
**Target**: Enterprise-Grade Financial Intelligence Platform

---

## ðŸš¨ Phase 1: Critical Security & Integrity (Immediate Priority)

These items represent significant risks to data integrity, security, or financial accuracy.

- [ ] **[CRITICAL] Migrate Float to Decimal** (`backend/quant_engine.py`, `backend/agents/portfolio_agent.py`)
    - [ ] Replace Python `float` with `decimal.Decimal` for all currency calculations.
    - [ ] Implement `QuantizationContext` to handle rounding modes (e.g., `ROUND_HALF_UP`) consistently.
    - [ ] Audit all P&L formulas to ensure no binary floating-point errors remain.
- [ ] **[CRITICAL] Sandbox Security Hardening** (`backend/utils/safe_python.py`)
    - [ ] Audit `SafePythonExecutor` for AST bypass vulnerabilities.
    - [ ] **Action**: Move Python code execution to a Dockerized container or WebAssembly (WASM) sandbox instead of `exec()`.
    - [ ] Restrict `import` capabilities strictly to a whitelist (`math`, `statistics` only).
- [ ] **[CRITICAL] Audit Trails** (`backend/app_logging.py`)
    - [ ] Implement structured audit logging for all financial decisions/advice generated by the AI.
    - [ ] Log unique `conversation_id`, `decision_id`, `timestamp`, and `model_version` for every piece of advice.
    - [ ] Ensure audit logs are tamper-evident (hashing/chaining).

---

## ðŸ› ï¸ Phase 2: Architecture & Scalability (Short Term)

Refactoring technical debt to support future growth and performance.

- [ ] **[HIGH] Centralized Ticker Service**
    - [ ] Create a dedicated `TickerResolutionService` (or `TickerRegistry`).
    - [ ] Consolidate normalization logic from `CoordinatorAgent`, `DataFabricator`, and `trading212_mcp_server`.
    - [ ] Implement a unified mapping database for global symbols (e.g., US -> UK equivalents).
- [ ] **[HIGH] Dependency Injection Refactor**
    - [ ] Remove reliance on global `state` object in `backend/app_context.py`.
    - [ ] Refactor `server.py` to use FastAPI dependency injection (`Depends(get_app_state)`).
    - [ ] Pass `AppState` explicitly to agents to improve testability.
- [ ] **[HIGH] Response Streaming (SSE)**
    - [ ] Implement Server-Sent Events (SSE) for `POST /api/chat/message`.
    - [ ] Stream intermediate status updates ("Fetching prices...", "Running quant model...") to the frontend.
    - [ ] Reduce perceived latency from ~5-8s to <500ms (time to first token).

---

## ðŸš€ Phase 3: Features & Capabilities (Medium Term)

Enhancing the user value proposition.

### Market Intelligence
- [ ] **Real-Time Data Streaming**
    - [ ] Integrate WebSocket support for Alpaca/Finnhub data in `DataFabricator`.
    - [ ] Push live price updates to the frontend via WebSocket.
- [ ] **News & Sentiment 2.0**
    - [ ] Integrate NewsData.io fully (currently experimental).
    - [ ] Implement entity extraction to link news articles to specific portfolio holdings automatically.
    - [ ] Add "Whale Watch" alerts for significant institutional movements.

### Core AI
- [ ] **CoreML Integration** (`backend/coreml_inference.py`)
    - [ ] Finalize the pipeline to run small quant models directly on the Neural Engine (ANE).
    - [ ] Benchmark latency vs. MLX.
- [ ] **Personalized Advisor Persona**
    - [ ] Implement user preference learning (e.g., "I prefer aggressive growth", "I am risk-averse").
    - [ ] Store user "Financial Identity" in `sqlite` and inject into `DecisionAgent` prompt.

---

## ðŸ“‰ Phase 4: Frontend (macOS / SwiftUI)

- [ ] **[UI] Advanced Charting**
    - [ ] Implement interactive candlestick charts with technical indicators overlays (SMA, Bollinger Bands).
    - [ ] Add zoom/pan gestures to historical charts.
- [ ] **[UX] Voice Input**
    - [ ] Add microphone support to Chat View using macOS native speech recognition.
- [ ] **[UX] Notifications**
    - [ ] Implement local push notifications for price alerts and trade execution confirmations.

---

## ðŸ§ª Phase 5: Testing & DevOps

- [ ] **Integration Testing**
    - [ ] Create a "Golden Set" of 50 financial queries to benchmark AI accuracy.
    - [ ] Automate regression testing for the `DecisionAgent` prompt.
- [ ] **Performance Benchmarking**
    - [ ] Setup a continuous benchmark for `DataFabricator` latency.
    - [ ] Monitor memory usage of MLX models over long-running sessions.
- [ ] **CI/CD**
    - [ ] Enforce pre-commit hooks for `ruff` linting.
    - [ ] Automate `pytest` execution on GitHub Actions (once repo policy allows).

---

## âœ… Completed / In Maintenance

- [x] **Secret Masking**: `SecretMasker` middleware implemented.
- [x] **Data IO Separation**: `DataFabricator` created to decouple IO from Agents.
- [x] **Vectorized Quant**: Bolt optimization applied to `yfinance` fallback.
- [x] **Coordinator Guardrails**: IBM Granite-tiny implemented for routing.
